<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>grep/sed/awk commands - khanalinc</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="generator" content="mkdocs-1.1.2, mkdocs-gitbook-1.0.7">

<link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon">
<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta rel="next" href="" />
<link href="../../css/style.min.css" rel="stylesheet"> 
</head>

<body>
<div class="book">
<div class="book-summary">
<div id="book-search-input" role="search">
<input type="text" placeholder="Type to search" />
</div> <!-- end of book-search-input -->

<nav role="navigation">
<ul class="summary">
<li>
<a href="../.." target="_blank" class="custom-link">khanalinc</a>
</li>
<li class="divider"></li>
<li class="chapter" data-path="">
<a href="../..">Home</a>
<li class="header">Linux Useful Tips</li>

<li>
<a href="../vi/" class="">vi commands</a>
</li>

<li>
<a href="./" class="active">grep/sed/awk commands</a>
</li>

<li class="header">Python</li>

<li>
<a href="../../python/python_numpy_scipy/" class="">Numpy/Scipy examples</a>
</li>

<li>
<a href="../../python/python_pandas/" class="">Pandas examples</a>
</li>

<li class="header">Machine Learning</li>

<li>
<a href="../../ml/ml_basics/" class="">Implimenting the Basics</a>
</li>

<li>
<a href="../../ml/deepnn_imp/" class="">Implimenting Deep Neural Network</a>
</li>

<li>
<a href="../../ml/compare_classification/" class="">Classification Comarision</a>
</li>

<li class="header">Quantum Computing</li>

<li>
<a href="../../qc/qft/" class="">Quantum Fourier Transform</a>
</li>

<li class="divider"></li>



<li><a href="http://www.mkdocs.org">
Published with MkDocs
</a></li>

<li><a href="https://github.com/GitbookIO/theme-default">
Theme by GitBook
</a></li>
</ul>

</nav>

</div> <!-- end of book-summary -->

<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">

<!-- Title -->
<h1>
<i class="fa fa-circle-o-notch fa-spin"></i>
<a href="." ></a>
</h1>

</div> <!-- end of book-header -->

<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">
<div id="book-search-results">
<div class="search-noresults">

<section class="normal markdown-section">



<h1 id="grep-and-egrep">Grep and Egrep</h1>
<h2 id="commands">commands</h2>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>-i            [ignore case]
-v            [invert the match]
-o            [only the matching]
-A [num]      [print the [num] lines after the match]
-B [num]      [print the [num] lines before the match] 
</code></pre></div>


<ul>
<li>First grep something from a file and then find the last line from that grepped file.</li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>find FeSe.scf |xargs grep FGL002 |tail -1
</code></pre></div>


<p>Finds <strong>FGL002</strong> in file <strong>.scf</strong> and returns the last line </p>
<ul>
<li>Find only specific numbers from a line</li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>less log.ctqmc | egrep -o &quot;&lt;Sz&gt;=-?[0-9].[0-9]+&quot; | egrep -oe ’-?[0-9].[0-9]+’ &gt; sz_data
</code></pre></div>


<ul>
<li>Find only the numbers from the grepped entity. use regular expression. egrep is for extended grep.</li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>find FeSe.scf |xargs grep :FER |tail -1| egrep -o [0-9].[0-9]+
</code></pre></div>


<h3 id="regular-expressions">Regular Expressions</h3>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>^[-+]?[0-9]*\.?[0-9]+$

  ^ - start of string
  $ - the end of string
  [0-9]? - 0 or 1 sign indicator
  [0-9]*  - 0 or more integers
  [0-9]+  - 1 or more integers
  \.  - the charcter (. is used in regex to mean &quot;any character&quot;)
</code></pre></div>


<h1 id="sed-and-awk">Sed and Awk</h1>
<h2 id="commands_1"><strong>Commands</strong></h2>
<ul>
<li><strong>p</strong> print</li>
<li><strong>d</strong> delete</li>
<li><strong>s</strong> substitute</li>
<li><strong>a</strong> append</li>
<li><strong>i</strong> insert</li>
<li><strong>c</strong> change</li>
<li><strong>y</strong> transform</li>
<li><strong>q</strong> quit</li>
</ul>
<p>!!<strong>Things to note</strong></p>
<ul>
<li><strong>$</strong> represents the last line</li>
<li><strong>^$</strong> represents blank line.</li>
</ul>
<h2 id="sed-syntax"><strong>sed Syntax</strong></h2>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>sed [-n] [-e] [&#39;command&#39;] [file]
</code></pre></div>


<ul>
<li><strong>-n</strong> only prints line specified with the print command</li>
<li><strong>-e</strong> The next argument is a filename containing editing commands</li>
</ul>
<h2 id="print"><strong>print</strong></h2>
<p>Command <strong>p</strong> [<strong>p</strong>rint only certain lines]</p>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>Syntax:    [address1[,address2]]p
</code></pre></div>


<p><strong>Examples:</strong></p>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>sed -n &#39;5,10p&#39; file.dat     Print lines from line 5 to line 10
sed -n &#39;5p&#39; file.dat        Print only 5th line
sed -n &#39;5,$p&#39; file.dat      Print lines from 5th to last line
</code></pre></div>


<h2 id="delete"><strong>delete</strong></h2>
<p>Command <strong>d</strong> [<strong>d</strong>elete certain line]</p>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>Syntax:    [address1[,address2]]d
</code></pre></div>


<p>!!Examples:</p>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>sed &#39;5d&#39; file.dat           [Delete line 5 while printing]
sed &#39;5,10d&#39; file.dat        [Delete lines from 5th to 10th while printing]
sed &#39;/^$d&#39; file.dat         [Delete line 5 while printing]
sed &#39;/^$/,$d&#39; file.dat      [Delete from first blank line through last line.]
sed &#39;/str/,$d&#39; file.dat     [Delete all lines after the line containing string **str**. [Also has to be single quotation mark.]
</code></pre></div>


<h2 id="substitute"><strong>Substitute</strong></h2>
<p>Command <strong>s</strong> [<strong>s</strong>ubstitute <strong>AA</strong> by <strong>BB</strong>]</p>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>Syntax:    [address(es)]s/pattern/replacement/[flags]
           flags: n   [nth occurrence]
                : g   [global occurrence]
</code></pre></div>


<h3 id="examples">Examples:</h3>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>sed ‘s/ AA/ BB/’ file.dat      Only the first occurrence
sed ‘s/ AA/ BB/g’ file.dat     global (all) occurrences
sed -i ‘s/ AA/ BB/g’ file.dat     replace in file (all) occurrences
</code></pre></div>


<ul>
<li>For a pattern which occurs multiple times in a file, replace only some of them. [Remember sig.inp for ferromagnetic calculations]</li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>sed &#39;s/AA/BB/2&#39;                Replace only 2nd occurrence
sed &#39;s/AA/BB/2g&#39;               Replace all after 2nd occurrence
</code></pre></div>


<p>!!Note: while using sed in bash shell, be careful about '{text}' and "{text}" the later has been useful. Learn when to use one and when the other.</p>
<p><strong>More information can be on</strong></p>
<p>A great course for learning UNIX
http://www.cs.nyu.edu/~mohri/unix08/</p>
<p>Basic Unix commands
http://unixcommandstutorial.blogspot.com/2013/04/unixawkperl-sqlplsql-examples.html</p>
<p>some tutorials on awk 
http://www.grymoire.com/Unix/Awk.html#uh-14</p>
<h2 id="awk"><strong>awk</strong></h2>
<p>awk can be as useful as sed and in many cases even better. </p>
<ul>
<li>print only some columns of some output</li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>awk &#39;{print $2}&#39; file.txt                 [print 2nd column]
grep &#39;str&#39; file.txt |awk &#39;{print $2}&#39;     [print 2nd column of the output]
grep &#39;str&#39; file.txt |awk &#39;{print $2 $3}&#39;  [print 2nd and 3rd column]
</code></pre></div>


<ul>
<li>print only some rows from file</li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>awk &#39;NR==1{print}&#39; file.txt          [print 1st line]
awk &#39;NR==1;END{print}&#39; file.txt      [print first and last line.]
awk &#39;NR==1;END{print $2}&#39; file.txt   [print 2nd column of first and last line.]
</code></pre></div>


<ul>
<li>find pattern and print only certain column</li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>awk &#39;/pattern/{print $1}&#39; file    [find lines with pattern and print first column]
</code></pre></div>


<p>!Sed/Awk inside a bash script</p>
<p>Insied a bash script you have to be little careful using sed and awk, especially if you are using a variable inside a sed command. For example the following command inside a bash script
<code>sed -i 's/${var1}/${var2}' filename.dat</code>
<strong>won't work</strong>. First thing is it needs double quotes <code>**</code> as opposed to single quotes <code>'</code> and the second thing is the <code>/</code> sign must be replaced by apersand  symbol <code>&amp;</code>. So the correct command would be <code>sed -i **s&amp;${var1}&amp;${var2}&amp;g** filename.dat</code></p>
<h3 id="sed-deleting-last-n-lines-of-a-file">Sed deleting last n lines of a file</h3>
<ul>
<li><strong>Option1: delete one line at a time for n times.</strong> very expensive for large files. </li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>for i in `seq 1 n`; do
    sed -i &#39;${d}&#39; file.txt
</code></pre></div>


<ul>
<li><strong>Option2: print the file in reverse using <code>tac</code> and cut the first n lines and reverse the file once again using <code>tac</code>.</strong></li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>tac file.txt |sed &#39;1,n{d}&#39; |tac  &gt; file_tmp
mv file_tmp file.txt
</code></pre></div>


<ul>
<li><strong>Option3: Found in the webpage  <a href="http://www.unixguide.net/unix/sedoneliner.shtml">sedoneliner</a></strong></li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>sed -i -e :a -e &#39;$d;N;2,4ba&#39; -e &#39;P;D&#39; test_file
</code></pre></div>


<ul>
<li><strong>Some other nice comands</strong></li>
</ul>
<div class="codehilite" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><code>sed -i -e &quot;1,${n0}d&quot; $f        # works  to delete lines from 1 to n0
 sed -i -e &quot;${n0},${n1}d&quot; $f   # deletes lines from n0 to n1
</code></pre></div>


</section>
</div> <!-- end of search-noresults -->
<div class="search-results">
<div class="has-results">

<!-- In the following the space was originally results matching-->
<h5 class="search-results-title"><span class='search-results-count'></span> </h1>
<!-- h5 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1 -->
<ul class="search-results-list"></ul>

</div> <!-- end of has-results -->
<div class="no-results">

<!-- In the following the space was originally No results matching-->
<!-- h5 class="search-results-title">No results matching "<span class='search-query'></span>"</h1 -->
<h5 class="search-results-title"> </h1>

</div> <!-- end of no-results -->
</div> <!-- end of search-results -->
</div> <!-- end of book-search-results -->

</div> <!-- end of page-inner -->
</div> <!-- end of page-wrapper -->

</div> <!-- end of body-inner -->

</div> <!-- end of book-body -->
<script src="../../js/main.js"></script>
<script src="../../search/main.js"></script>
<script src="../../js/gitbook.min.js"></script>
<script src="../../js/theme.min.js"></script>
</body>
</html>